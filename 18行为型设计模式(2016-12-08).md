# 行为型设计模式(2016/12/08)

标签（空格分隔）： 前端 js

---

> 今天的内容还是行为型设计模式。包括两个设计模式，备忘录模式和承诺模式。171页~184页。

### **行为型设计模式**
#### **备忘录模式**
> **备忘录模式**以静态形式在内存中定义对象数据的存储，这样在代码执行过程的后期就可以对对象数据进行恢复。

- 下面的代码通过JSON格式的字符串形式来保存对象的快照，并提供方法对原来JavaScript对象进行保存和恢复，从而实现备忘录模式。
- 备忘录模式：
```
//定义一个简单的类，用来实现备忘录模式。
//某些老式浏览器本身并不支持JSON.stringify()和JSON.parse()。对于这些浏览器，
//我们可以引用Dougla Crockford的库，网址：https://github.com/dougalscrockford/JSON-js
function Memento(){
	this.storage = {};
}

Memento.prototype.saveState = function(key, obj){
	this.storage[key] = JSON.stringify(obj);
};

Memento.prototype.restoreState = function(key){
	var output = {};

	if(this.storage.hasOwnProperty(key)){
		output = this.storage[key];

		output = JSON.parse(output);
	}

	return output;
};
```

- 使用备忘录模式：
```
var memento = new Memento(),
	user = {
		name: 'quan',
		age: 20
	};

memento.saveState('user', user);

console.log(memento.storage['user']);	//{"name":"quan", "age":20}		是个字符串

user.name = 'shuaiquan';
user.age = 100;

console.log(JSON.stringify(user));		//{"name":"shuaiquan", "age":100}

user = memento.restoreState('user');

console.log(JSon.stringify(user));		//{"name":"quan", "age":20}
```
> 当需要在应用程序执行的特定时刻把其中的对象进行保存和恢复时，使用备忘录模式最为合适。
#### **承诺模式**
